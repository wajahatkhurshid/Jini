/*
Deployment script for Gyldendal.Jini.Database

This code was generated by a tool.
Changes to this file may cause incorrect behavior and will be lost if
the code is regenerated.
*/

GO
SET ANSI_NULLS, ANSI_PADDING, ANSI_WARNINGS, ARITHABORT, CONCAT_NULL_YIELDS_NULL, QUOTED_IDENTIFIER ON;

SET NUMERIC_ROUNDABORT OFF;


GO
:setvar DatabaseName "Gyldendal.Jini.Database"
:setvar DefaultFilePrefix "Gyldendal.Jini.Database"
:setvar DefaultDataPath "C:\Users\wajahat.khurshid\AppData\Local\Microsoft\VisualStudio\SSDT\Gyldendal.Jini"
:setvar DefaultLogPath "C:\Users\wajahat.khurshid\AppData\Local\Microsoft\VisualStudio\SSDT\Gyldendal.Jini"

GO
:on error exit
GO
/*
Detect SQLCMD mode and disable script execution if SQLCMD mode is not supported.
To re-enable the script after enabling SQLCMD mode, execute the following:
SET NOEXEC OFF; 
*/
:setvar __IsSqlCmdEnabled "True"
GO
IF N'$(__IsSqlCmdEnabled)' NOT LIKE N'True'
    BEGIN
        PRINT N'SQLCMD mode must be enabled to successfully execute this script.';
        SET NOEXEC ON;
    END


GO
USE [$(DatabaseName)];


GO
IF EXISTS (SELECT 1
           FROM   [master].[dbo].[sysdatabases]
           WHERE  [name] = N'$(DatabaseName)')
    BEGIN
        ALTER DATABASE [$(DatabaseName)]
            SET ARITHABORT ON,
                CONCAT_NULL_YIELDS_NULL ON,
                CURSOR_DEFAULT LOCAL 
            WITH ROLLBACK IMMEDIATE;
    END


GO
IF EXISTS (SELECT 1
           FROM   [master].[dbo].[sysdatabases]
           WHERE  [name] = N'$(DatabaseName)')
    BEGIN
        ALTER DATABASE [$(DatabaseName)]
            SET PAGE_VERIFY NONE,
                DISABLE_BROKER 
            WITH ROLLBACK IMMEDIATE;
    END


GO
ALTER DATABASE [$(DatabaseName)]
    SET TARGET_RECOVERY_TIME = 0 SECONDS 
    WITH ROLLBACK IMMEDIATE;


GO
IF EXISTS (SELECT 1
           FROM   [master].[dbo].[sysdatabases]
           WHERE  [name] = N'$(DatabaseName)')
    BEGIN
        ALTER DATABASE [$(DatabaseName)]
            SET QUERY_STORE (CLEANUP_POLICY = (STALE_QUERY_THRESHOLD_DAYS = 367)) 
            WITH ROLLBACK IMMEDIATE;
    END


GO
PRINT N'Rename refactoring operation with key 40677309-3065-47ad-b6f2-6c8bfdc4753b is skipped, element [dbo].[RefAccessForm].[Name] (SqlSimpleColumn) will not be renamed to Code';


GO
PRINT N'Rename refactoring operation with key 509c4388-cc48-46e4-9783-adbfc34ad01a is skipped, element [dbo].[PriceModel].[Name] (SqlSimpleColumn) will not be renamed to Code';


GO
PRINT N'Rename refactoring operation with key 560a9f00-e386-4e35-b499-a15a37341dd2 is skipped, element [dbo].[PeriodPrice].[Name] (SqlSimpleColumn) will not be renamed to Code';


GO
PRINT N'Rename refactoring operation with key dff428cb-5444-44db-a093-58519ebddcc3 is skipped, element [dbo].[PeriodUnitPrice].[PeriodId] (SqlSimpleColumn) will not be renamed to PeriodPriceId';


GO
PRINT N'Rename refactoring operation with key 7bb63826-89bc-48d1-a55c-34058dccf9bd, 580fb8dc-579e-47ba-a179-e0ae10185b31 is skipped, element [dbo].[RefPeriodType].[Name] (SqlSimpleColumn) will not be renamed to Code';


GO
PRINT N'Rename refactoring operation with key 84ff1e01-e375-4051-be96-314f80d6bea6 is skipped, element [dbo].[RefPeriodUnitType].[Name] (SqlSimpleColumn) will not be renamed to Code';


GO
PRINT N'Rename refactoring operation with key 63315d65-4e8d-4358-80c0-b878fef1448d is skipped, element [dbo].[RefPriceModel].[Name] (SqlSimpleColumn) will not be renamed to Code';


GO
PRINT N'Rename refactoring operation with key 996b82a9-60c7-4359-be51-ee5eb2d08f84 is skipped, element [dbo].[RefSalesForm].[Name] (SqlSimpleColumn) will not be renamed to Code';


GO
PRINT N'Rename refactoring operation with key 2946c98e-5b25-41d2-b9ee-e68c3f029cee is skipped, element [dbo].[AccessForm].[Text] (SqlSimpleColumn) will not be renamed to WebText';


GO
PRINT N'Rename refactoring operation with key 8abdd0d9-bf99-4d99-8bdb-c941e2704622 is skipped, element [dbo].[RefAccessForm].[Text] (SqlSimpleColumn) will not be renamed to WebText';


GO
PRINT N'Rename refactoring operation with key 9c1a6d55-79ca-4d60-a994-d46aaca78808, c5263f43-efa2-4674-9fc1-c52320543a77 is skipped, element [dbo].[SalesConfigurationHistory].[Version] (SqlSimpleColumn) will not be renamed to VersionNo';


GO
PRINT N'Rename refactoring operation with key 7dd42961-5ac2-496e-98e3-2e5b3e4b970a is skipped, element [dbo].[AK_RefAccessForm_Column] (SqlUniqueConstraint) will not be renamed to [Unique_Code]';


GO
PRINT N'Rename refactoring operation with key ded82f81-7185-4a01-b9bb-9dcbde7f30a4 is skipped, element [dbo].[RefPeriod].[RefPeriodUnitTypeId] (SqlSimpleColumn) will not be renamed to RefPeriodUnitTypeCode';


GO
PRINT N'Rename refactoring operation with key 33f56b1c-be7e-43d8-8721-f85f1b57f3dc is skipped, element [dbo].[RefPeriod].[RefSalesFormId] (SqlSimpleColumn) will not be renamed to RefSalesFormCode';


GO
PRINT N'Rename refactoring operation with key 71b44a59-cb8a-466a-927d-b53d7637cc41 is skipped, element [dbo].[RefPriceModel].[RefAccessFormId] (SqlSimpleColumn) will not be renamed to RefAccessFormCode';


GO
PRINT N'Rename refactoring operation with key 49eba622-23ee-4ffa-af4d-79931dcc9a82 is skipped, element [dbo].[SalesForm].[RefCode] (SqlSimpleColumn) will not be renamed to RefSalesFormCode';


GO
PRINT N'Rename refactoring operation with key 93bc6876-5c7c-4378-bef4-f1138c7752f1 is skipped, element [dbo].[PeriodPrice].[UnitType] (SqlSimpleColumn) will not be renamed to RefPeriodTypeCode';


GO
PRINT N'Rename refactoring operation with key 2ad039dd-3fb0-4c05-8ea3-56adea82ea35 is skipped, element [dbo].[RefTrialPeriodUnitType].[Id] (SqlSimpleColumn) will not be renamed to Code';


GO
PRINT N'Rename refactoring operation with key 5833656e-1b12-429a-968e-6d7d9df846fb is skipped, element [dbo].[TrialPeriod].[Id] (SqlSimpleColumn) will not be renamed to UnitValue';


GO
PRINT N'Rename refactoring operation with key 98aeff9b-2d05-4fb7-947e-da90006c04cf is skipped, element [dbo].[TrialPeriod].[RefTrialPeriod] (SqlSimpleColumn) will not be renamed to RefTrialPeriodTypeCode';


GO
PRINT N'Rename refactoring operation with key 9e0f07b0-d6b0-4a98-ab4e-40973231bb70 is skipped, element [dbo].[TrialAccess].[TrialPeriod] (SqlSimpleColumn) will not be renamed to TrialPeriodId';


GO
PRINT N'Rename refactoring operation with key 5d59fe7d-0735-446b-a89e-57d7e9a16949 is skipped, element [dbo].[TrialAccess].[TrialCount] (SqlSimpleColumn) will not be renamed to TrialCountId';


GO
PRINT N'Rename refactoring operation with key e9251e02-0b03-4ca2-8772-6b48f55b4f2d is skipped, element [dbo].[RefTrialAccessForm].[Id] (SqlSimpleColumn) will not be renamed to Code';


GO
PRINT N'Rename refactoring operation with key 5e56c8bd-eee4-4d3e-9da3-d8e0888543a3 is skipped, element [dbo].[TrialAccess].[AccessFormCode] (SqlSimpleColumn) will not be renamed to TrialAccessFormCode';


GO
PRINT N'Rename refactoring operation with key d6102a52-4ffc-4162-b236-531ffd4866af is skipped, element [dbo].[FK_TrialAccess_RefAccessForm] (SqlForeignKeyConstraint) will not be renamed to [FK_TrialAccess_RefTrialAccessForm]';


GO
PRINT N'Rename refactoring operation with key 863b6c39-0d35-4244-84a2-ea4b7a9034ea is skipped, element [dbo].[RefTrialCountUnitType].[Id] (SqlSimpleColumn) will not be renamed to Code';


GO
PRINT N'Rename refactoring operation with key e444e73a-080a-4f82-97f7-a0bcffa6bce8 is skipped, element [dbo].[TrialCount].[RefPeriodUnitTypeCode] (SqlSimpleColumn) will not be renamed to RefCountUnitTypeCode';


GO
PRINT N'Rename refactoring operation with key 15850ff4-b336-4184-a5de-5b43217f8d7c is skipped, element [dbo].[Seller].[WebSiteId] (SqlSimpleColumn) will not be renamed to WebShopId';


GO
PRINT N'Rename refactoring operation with key 8c4ab0a6-9fae-4811-b515-b8c1b9df3360 is skipped, element [dbo].[FK_TrialCount_ToTable] (SqlForeignKeyConstraint) will not be renamed to [FK_TrialCount_RefTrialCountUnitType]';


GO
PRINT N'Creating Table [dbo].[AccessForm]...';


GO
CREATE TABLE [dbo].[AccessForm] (
    [Id]                   INT            IDENTITY (1, 1) NOT NULL,
    [SalesConfigurationId] INT            NOT NULL,
    [RefCode]              INT            NOT NULL,
    [WebText]              NVARCHAR (500) NULL,
    [DescriptionText]      NVARCHAR (MAX) NULL,
    CONSTRAINT [PK_SalesConfiguration_AccessForm] PRIMARY KEY CLUSTERED ([Id] ASC)
);


GO
PRINT N'Creating Index [dbo].[AccessForm].[_dta_index_AccessForm_17]...';


GO
CREATE NONCLUSTERED INDEX [_dta_index_AccessForm_17]
    ON [dbo].[AccessForm]([SalesConfigurationId] ASC, [Id] ASC, [RefCode] ASC)
    INCLUDE([WebText], [DescriptionText]);


GO
PRINT N'Creating Table [dbo].[DbVersion]...';


GO
CREATE TABLE [dbo].[DbVersion] (
    [Id]          INT            IDENTITY (1, 1) NOT NULL,
    [VersionNo]   NVARCHAR (50)  NOT NULL,
    [SequenceNo]  INT            NOT NULL,
    [CreatedDate] DATETIME       NOT NULL,
    [Note]        NVARCHAR (250) NULL,
    [ScriptName]  NVARCHAR (250) NOT NULL,
    CONSTRAINT [PK_DbVersion] PRIMARY KEY CLUSTERED ([Id] ASC)
);


GO
PRINT N'Creating Table [dbo].[Dealer]...';


GO
CREATE TABLE [dbo].[Dealer] (
    [Id]                   INT           NOT NULL,
    [Code]                 INT           NOT NULL,
    [Url]                  NVARCHAR (50) NULL,
    [DealerName]           NVARCHAR (50) NULL,
    [DealerType]           NVARCHAR (50) NULL,
    [SalesConfigurationId] INT           NOT NULL,
    CONSTRAINT [PK_Dealer_1] PRIMARY KEY CLUSTERED ([Id] ASC)
);


GO
PRINT N'Creating Table [dbo].[PeriodPrice]...';


GO
CREATE TABLE [dbo].[PeriodPrice] (
    [Id]                INT           IDENTITY (1, 1) NOT NULL,
    [UnitValue]         INT           NOT NULL,
    [RefPeriodTypeCode] INT           NOT NULL,
    [AccessFormId]      INT           NOT NULL,
    [Currency]          NVARCHAR (10) NOT NULL,
    [UnitPrice]         MONEY         NOT NULL,
    [UnitPriceVat]      MONEY         NOT NULL,
    [VatValue]          INT           NOT NULL,
    [IsCustomPeriod]    BIT           NOT NULL,
    CONSTRAINT [PK_SalesConfigurationPeriod] PRIMARY KEY CLUSTERED ([Id] ASC)
);


GO
PRINT N'Creating Table [dbo].[PriceModel]...';


GO
CREATE TABLE [dbo].[PriceModel] (
    [id]                INT           IDENTITY (1, 1) NOT NULL,
    [AccessFormId]      INT           NOT NULL,
    [RefPriceModelCode] INT           NOT NULL,
    [PercentValue]      INT           NULL,
    [GradeLevels]       NVARCHAR (50) NULL,
    CONSTRAINT [PK_AccessPriceModel] PRIMARY KEY CLUSTERED ([id] ASC)
);


GO
PRINT N'Creating Table [dbo].[Product]...';


GO
CREATE TABLE [dbo].[Product] (
    [Id]              INT          IDENTITY (1, 1) NOT NULL,
    [IsExternalLogin] BIT          NOT NULL,
    [Isbn]            VARCHAR (13) NOT NULL,
    PRIMARY KEY CLUSTERED ([Id] ASC)
);


GO
PRINT N'Creating Table [dbo].[ProductAccessProvider]...';


GO
CREATE TABLE [dbo].[ProductAccessProvider] (
    [Id]               INT IDENTITY (1, 1) NOT NULL,
    [AccessProviderId] INT NOT NULL,
    [ProductId]        INT NOT NULL,
    PRIMARY KEY CLUSTERED ([Id] ASC)
);


GO
PRINT N'Creating Table [dbo].[RefAccessForm]...';


GO
CREATE TABLE [dbo].[RefAccessForm] (
    [Code]               INT            NOT NULL,
    [DisplayName]        NVARCHAR (50)  NOT NULL,
    [WebText]            NVARCHAR (500) NULL,
    [ExternalIdentifier] INT            NULL,
    CONSTRAINT [PK_AccessForm] PRIMARY KEY CLUSTERED ([Code] ASC),
    CONSTRAINT [Code_RefAccessForm] UNIQUE NONCLUSTERED ([Code] ASC)
);


GO
PRINT N'Creating Table [dbo].[RefAccessProvider]...';


GO
CREATE TABLE [dbo].[RefAccessProvider] (
    [Code]        INT           NOT NULL,
    [Identifier]  VARCHAR (100) NOT NULL,
    [DisplayName] VARCHAR (100) NULL,
    PRIMARY KEY CLUSTERED ([Code] ASC)
);


GO
PRINT N'Creating Table [dbo].[RefDealer]...';


GO
CREATE TABLE [dbo].[RefDealer] (
    [Id]              INT            IDENTITY (1, 1) NOT NULL,
    [Name]            NVARCHAR (50)  NULL,
    [Text]            NVARCHAR (500) NULL,
    [LogoImage]       NVARCHAR (10)  NULL,
    [RefDealerTextId] INT            NOT NULL,
    CONSTRAINT [PK_Dealer] PRIMARY KEY CLUSTERED ([Id] ASC)
);


GO
PRINT N'Creating Table [dbo].[RefDealerText]...';


GO
CREATE TABLE [dbo].[RefDealerText] (
    [Id]   INT            IDENTITY (1, 1) NOT NULL,
    [Text] NVARCHAR (500) NULL,
    CONSTRAINT [PK_DealerText] PRIMARY KEY CLUSTERED ([Id] ASC)
);


GO
PRINT N'Creating Table [dbo].[RefPeriod]...';


GO
CREATE TABLE [dbo].[RefPeriod] (
    [Id]                    INT IDENTITY (1, 1) NOT NULL,
    [UnitValue]             INT NOT NULL,
    [RefPeriodUnitTypeCode] INT NOT NULL,
    CONSTRAINT [PK_Period] PRIMARY KEY CLUSTERED ([Id] ASC)
);


GO
PRINT N'Creating Table [dbo].[RefPeriodUnitType]...';


GO
CREATE TABLE [dbo].[RefPeriodUnitType] (
    [Code]        INT           NOT NULL,
    [DisplayName] NVARCHAR (50) NOT NULL,
    CONSTRAINT [PK_PeriodDurationType] PRIMARY KEY CLUSTERED ([Code] ASC),
    CONSTRAINT [Code_RefPeriodUnitType] UNIQUE NONCLUSTERED ([Code] ASC)
);


GO
PRINT N'Creating Table [dbo].[RefPriceModel]...';


GO
CREATE TABLE [dbo].[RefPriceModel] (
    [Code]              INT            NOT NULL,
    [DisplayName]       NVARCHAR (50)  NOT NULL,
    [RefAccessFormCode] INT            NOT NULL,
    [Text]              NVARCHAR (500) NULL,
    [ShowPercentage]    BIT            NOT NULL,
    CONSTRAINT [PK_PriceModel] PRIMARY KEY CLUSTERED ([Code] ASC),
    CONSTRAINT [Code_RefPriceModel] UNIQUE NONCLUSTERED ([Code] ASC)
);


GO
PRINT N'Creating Table [dbo].[RefSalesChannel]...';


GO
CREATE TABLE [dbo].[RefSalesChannel] (
    [Id]   INT           NOT NULL,
    [Name] NVARCHAR (10) NOT NULL,
    CONSTRAINT [PK_SalesChannel] PRIMARY KEY CLUSTERED ([Id] ASC)
);


GO
PRINT N'Creating Table [dbo].[RefSalesConfigType]...';


GO
CREATE TABLE [dbo].[RefSalesConfigType] (
    [Code]        INT          NOT NULL,
    [DisplayName] VARCHAR (25) NOT NULL,
    PRIMARY KEY CLUSTERED ([Code] ASC)
);


GO
PRINT N'Creating Table [dbo].[RefSalesForm]...';


GO
CREATE TABLE [dbo].[RefSalesForm] (
    [Code]               INT           NOT NULL,
    [DisplayName]        NVARCHAR (50) NOT NULL,
    [ExternalIdentifier] INT           NOT NULL,
    [PeriodTypeName]     NVARCHAR (50) NULL,
    CONSTRAINT [PK_SalesForm] PRIMARY KEY CLUSTERED ([Code] ASC),
    CONSTRAINT [Code_RefSalesForm] UNIQUE NONCLUSTERED ([Code] ASC)
);


GO
PRINT N'Creating Table [dbo].[RefSeller]...';


GO
CREATE TABLE [dbo].[RefSeller] (
    [Id]   INT           IDENTITY (1, 1) NOT NULL,
    [Name] NVARCHAR (50) NOT NULL,
    CONSTRAINT [PK_RefSeller] PRIMARY KEY CLUSTERED ([Id] ASC)
);


GO
PRINT N'Creating Table [dbo].[RefTrialAccessForm]...';


GO
CREATE TABLE [dbo].[RefTrialAccessForm] (
    [Code]        INT           NOT NULL,
    [DisplayName] NVARCHAR (50) NOT NULL,
    PRIMARY KEY CLUSTERED ([Code] ASC)
);


GO
PRINT N'Creating Table [dbo].[RefTrialCountUnitType]...';


GO
CREATE TABLE [dbo].[RefTrialCountUnitType] (
    [Code]        INT           NOT NULL,
    [DisplayName] NVARCHAR (50) NOT NULL,
    PRIMARY KEY CLUSTERED ([Code] ASC) ON [PRIMARY]
) ON [PRIMARY];


GO
PRINT N'Creating Table [dbo].[RefTrialPeriodUnitType]...';


GO
CREATE TABLE [dbo].[RefTrialPeriodUnitType] (
    [Code]        INT           NOT NULL,
    [DisplayName] NVARCHAR (50) NOT NULL,
    PRIMARY KEY CLUSTERED ([Code] ASC) ON [PRIMARY]
) ON [PRIMARY];


GO
PRINT N'Creating Table [dbo].[SalesConfiguration]...';


GO
CREATE TABLE [dbo].[SalesConfiguration] (
    [Id]                     INT           IDENTITY (1, 1) NOT NULL,
    [Isbn]                   NVARCHAR (13) NOT NULL,
    [SellerId]               INT           NOT NULL,
    [SalesChannel]           NVARCHAR (50) NOT NULL,
    [State]                  INT           NOT NULL,
    [SalesFormId]            INT           NULL,
    [CreatedDate]            DATETIME      NOT NULL,
    [RevisionNumber]         INT           NOT NULL,
    [CreatedBy]              NVARCHAR (50) NOT NULL,
    [TrialLicenseId]         INT           NULL,
    [RefSalesConfigTypeCode] INT           NULL,
    CONSTRAINT [PK_SalesConfiguration] PRIMARY KEY CLUSTERED ([Id] ASC),
    CONSTRAINT [UC_SalesConfiguration] UNIQUE NONCLUSTERED ([Isbn] ASC, [SalesChannel] ASC, [State] ASC, [SalesFormId] ASC)
);


GO
PRINT N'Creating Table [dbo].[SalesConfigurationHistory]...';


GO
CREATE TABLE [dbo].[SalesConfigurationHistory] (
    [Id]          INT            IDENTITY (1, 1) NOT NULL,
    [CreatedDate] DATETIME       NOT NULL,
    [Value]       NVARCHAR (MAX) NOT NULL,
    [CreatedBy]   NVARCHAR (50)  NOT NULL,
    [VersionNo]   INT            NOT NULL,
    [Isbn]        NCHAR (50)     NOT NULL,
    CONSTRAINT [PK_SalesConfigurationHistory] PRIMARY KEY CLUSTERED ([Id] ASC)
);


GO
PRINT N'Creating Table [dbo].[SalesForm]...';


GO
CREATE TABLE [dbo].[SalesForm] (
    [Id]               INT IDENTITY (1, 1) NOT NULL,
    [RefSalesFormCode] INT NOT NULL,
    CONSTRAINT [PK_SalesConfiguration_SalesForm] PRIMARY KEY CLUSTERED ([Id] ASC)
);


GO
PRINT N'Creating Table [dbo].[Seller]...';


GO
CREATE TABLE [dbo].[Seller] (
    [Id]        INT           IDENTITY (1, 1) NOT NULL,
    [Name]      NVARCHAR (50) NOT NULL,
    [WebShopId] INT           NOT NULL,
    CONSTRAINT [PK_Seller] PRIMARY KEY CLUSTERED ([Id] ASC)
);


GO
PRINT N'Creating Table [dbo].[TrialCount]...';


GO
CREATE TABLE [dbo].[TrialCount] (
    [Id]                   INT IDENTITY (1, 1) NOT NULL,
    [UnitValue]            INT NULL,
    [RefCountUnitTypeCode] INT NOT NULL,
    CONSTRAINT [PK__TrialCou__3214EC07662179D3] PRIMARY KEY CLUSTERED ([Id] ASC) ON [PRIMARY]
) ON [PRIMARY];


GO
PRINT N'Creating Table [dbo].[TrialLicense]...';


GO
CREATE TABLE [dbo].[TrialLicense] (
    [Id]                  INT            IDENTITY (1, 1) NOT NULL,
    [TrialPeriodId]       INT            NULL,
    [MultipleTrials]      BIT            NOT NULL,
    [TrialAccessFormCode] INT            NULL,
    [TrialCountId]        INT            NULL,
    [ContactSalesText]    NVARCHAR (MAX) NULL,
    CONSTRAINT [PK__TrialLicense__3214EC076C44B463] PRIMARY KEY CLUSTERED ([Id] ASC) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY];


GO
PRINT N'Creating Table [dbo].[TrialPeriod]...';


GO
CREATE TABLE [dbo].[TrialPeriod] (
    [Id]                     INT IDENTITY (1, 1) NOT NULL,
    [UnitValue]              INT NOT NULL,
    [RefTrialPeriodTypeCode] INT NOT NULL,
    CONSTRAINT [PK__TrialPer__B0B31F907D642036] PRIMARY KEY CLUSTERED ([Id] ASC) ON [PRIMARY]
) ON [PRIMARY];


GO
PRINT N'Creating Default Constraint [dbo].[DF__PeriodPri__IsCus__35BCFE0A]...';


GO
ALTER TABLE [dbo].[PeriodPrice]
    ADD CONSTRAINT [DF__PeriodPri__IsCus__35BCFE0A] DEFAULT ((0)) FOR [IsCustomPeriod];


GO
PRINT N'Creating Default Constraint unnamed constraint on [dbo].[RefPriceModel]...';


GO
ALTER TABLE [dbo].[RefPriceModel]
    ADD DEFAULT ((0)) FOR [ShowPercentage];


GO
PRINT N'Creating Default Constraint unnamed constraint on [dbo].[Seller]...';


GO
ALTER TABLE [dbo].[Seller]
    ADD DEFAULT 0 FOR [WebShopId];


GO
PRINT N'Creating Foreign Key [dbo].[FK_AccessForm_RefAccessForm]...';


GO
ALTER TABLE [dbo].[AccessForm] WITH NOCHECK
    ADD CONSTRAINT [FK_AccessForm_RefAccessForm] FOREIGN KEY ([RefCode]) REFERENCES [dbo].[RefAccessForm] ([Code]);


GO
PRINT N'Creating Foreign Key [dbo].[FK_AccessForm_SalesConfiguration]...';


GO
ALTER TABLE [dbo].[AccessForm] WITH NOCHECK
    ADD CONSTRAINT [FK_AccessForm_SalesConfiguration] FOREIGN KEY ([SalesConfigurationId]) REFERENCES [dbo].[SalesConfiguration] ([Id]) ON DELETE CASCADE;


GO
PRINT N'Creating Foreign Key [dbo].[FK_PeriodPrice_RefPeriodUnitType]...';


GO
ALTER TABLE [dbo].[PeriodPrice] WITH NOCHECK
    ADD CONSTRAINT [FK_PeriodPrice_RefPeriodUnitType] FOREIGN KEY ([RefPeriodTypeCode]) REFERENCES [dbo].[RefPeriodUnitType] ([Code]);


GO
PRINT N'Creating Foreign Key [dbo].[FK_Period_AccessForm]...';


GO
ALTER TABLE [dbo].[PeriodPrice] WITH NOCHECK
    ADD CONSTRAINT [FK_Period_AccessForm] FOREIGN KEY ([AccessFormId]) REFERENCES [dbo].[AccessForm] ([Id]) ON DELETE CASCADE;


GO
PRINT N'Creating Foreign Key [dbo].[FK_PriceModel_AccessForm]...';


GO
ALTER TABLE [dbo].[PriceModel] WITH NOCHECK
    ADD CONSTRAINT [FK_PriceModel_AccessForm] FOREIGN KEY ([AccessFormId]) REFERENCES [dbo].[AccessForm] ([Id]) ON DELETE CASCADE;


GO
PRINT N'Creating Foreign Key [dbo].[FK_PriceModel_RefPriceModel]...';


GO
ALTER TABLE [dbo].[PriceModel] WITH NOCHECK
    ADD CONSTRAINT [FK_PriceModel_RefPriceModel] FOREIGN KEY ([RefPriceModelCode]) REFERENCES [dbo].[RefPriceModel] ([Code]);


GO
PRINT N'Creating Foreign Key [dbo].[FK_AccessProvider]...';


GO
ALTER TABLE [dbo].[ProductAccessProvider] WITH NOCHECK
    ADD CONSTRAINT [FK_AccessProvider] FOREIGN KEY ([AccessProviderId]) REFERENCES [dbo].[RefAccessProvider] ([Code]);


GO
PRINT N'Creating Foreign Key [dbo].[FK_Product]...';


GO
ALTER TABLE [dbo].[ProductAccessProvider] WITH NOCHECK
    ADD CONSTRAINT [FK_Product] FOREIGN KEY ([ProductId]) REFERENCES [dbo].[Product] ([Id]);


GO
PRINT N'Creating Foreign Key [dbo].[FK_RefDealer_RefDealerText]...';


GO
ALTER TABLE [dbo].[RefDealer] WITH NOCHECK
    ADD CONSTRAINT [FK_RefDealer_RefDealerText] FOREIGN KEY ([RefDealerTextId]) REFERENCES [dbo].[RefDealerText] ([Id]);


GO
PRINT N'Creating Foreign Key [dbo].[FK_RefPeriod_RefPeriodUnitType]...';


GO
ALTER TABLE [dbo].[RefPeriod] WITH NOCHECK
    ADD CONSTRAINT [FK_RefPeriod_RefPeriodUnitType] FOREIGN KEY ([RefPeriodUnitTypeCode]) REFERENCES [dbo].[RefPeriodUnitType] ([Code]);


GO
PRINT N'Creating Foreign Key [dbo].[FK_RefPriceModel_RefAccessForm]...';


GO
ALTER TABLE [dbo].[RefPriceModel] WITH NOCHECK
    ADD CONSTRAINT [FK_RefPriceModel_RefAccessForm] FOREIGN KEY ([RefAccessFormCode]) REFERENCES [dbo].[RefAccessForm] ([Code]);


GO
PRINT N'Creating Foreign Key [dbo].[FK_SalesConfiguration_RefSalesConfigType]...';


GO
ALTER TABLE [dbo].[SalesConfiguration] WITH NOCHECK
    ADD CONSTRAINT [FK_SalesConfiguration_RefSalesConfigType] FOREIGN KEY ([RefSalesConfigTypeCode]) REFERENCES [dbo].[RefSalesConfigType] ([Code]) ON DELETE CASCADE ON UPDATE CASCADE;


GO
PRINT N'Creating Foreign Key [dbo].[FK_SalesConfiguration_SalesForm]...';


GO
ALTER TABLE [dbo].[SalesConfiguration] WITH NOCHECK
    ADD CONSTRAINT [FK_SalesConfiguration_SalesForm] FOREIGN KEY ([SalesFormId]) REFERENCES [dbo].[SalesForm] ([Id]);


GO
PRINT N'Creating Foreign Key [dbo].[FK_SalesConfiguration_Seller]...';


GO
ALTER TABLE [dbo].[SalesConfiguration] WITH NOCHECK
    ADD CONSTRAINT [FK_SalesConfiguration_Seller] FOREIGN KEY ([SellerId]) REFERENCES [dbo].[Seller] ([Id]);


GO
PRINT N'Creating Foreign Key [dbo].[FK_SalesConfiguration_TrialLicense]...';


GO
ALTER TABLE [dbo].[SalesConfiguration] WITH NOCHECK
    ADD CONSTRAINT [FK_SalesConfiguration_TrialLicense] FOREIGN KEY ([TrialLicenseId]) REFERENCES [dbo].[TrialLicense] ([Id]);


GO
PRINT N'Creating Foreign Key [dbo].[FK_SalesForm_RefSalesForm]...';


GO
ALTER TABLE [dbo].[SalesForm] WITH NOCHECK
    ADD CONSTRAINT [FK_SalesForm_RefSalesForm] FOREIGN KEY ([RefSalesFormCode]) REFERENCES [dbo].[RefSalesForm] ([Code]);


GO
PRINT N'Creating Foreign Key [dbo].[FK_TrialCount_RefTrialCountUnitType]...';


GO
ALTER TABLE [dbo].[TrialCount] WITH NOCHECK
    ADD CONSTRAINT [FK_TrialCount_RefTrialCountUnitType] FOREIGN KEY ([RefCountUnitTypeCode]) REFERENCES [dbo].[RefTrialCountUnitType] ([Code]);


GO
PRINT N'Creating Foreign Key [dbo].[FK_TrialLicense_TrialCount]...';


GO
ALTER TABLE [dbo].[TrialLicense] WITH NOCHECK
    ADD CONSTRAINT [FK_TrialLicense_TrialCount] FOREIGN KEY ([TrialCountId]) REFERENCES [dbo].[TrialCount] ([Id]);


GO
PRINT N'Creating Foreign Key [dbo].[FK_TrialLicense_RefTrialAccessForm]...';


GO
ALTER TABLE [dbo].[TrialLicense] WITH NOCHECK
    ADD CONSTRAINT [FK_TrialLicense_RefTrialAccessForm] FOREIGN KEY ([TrialAccessFormCode]) REFERENCES [dbo].[RefTrialAccessForm] ([Code]);


GO
PRINT N'Creating Foreign Key [dbo].[FK_TrialLicense_TrialPeriod]...';


GO
ALTER TABLE [dbo].[TrialLicense] WITH NOCHECK
    ADD CONSTRAINT [FK_TrialLicense_TrialPeriod] FOREIGN KEY ([TrialPeriodId]) REFERENCES [dbo].[TrialPeriod] ([Id]);


GO
PRINT N'Creating Foreign Key [dbo].[FK__TrialPeri__RefTr__656C112C]...';


GO
ALTER TABLE [dbo].[TrialPeriod] WITH NOCHECK
    ADD CONSTRAINT [FK__TrialPeri__RefTr__656C112C] FOREIGN KEY ([RefTrialPeriodTypeCode]) REFERENCES [dbo].[RefTrialPeriodUnitType] ([Code]);


GO
PRINT N'Creating View [dbo].[DeflatedSalesConfigurationView]...';


GO
CREATE VIEW dbo.[DeflatedSalesConfigurationView]  
AS  
SELECT DISTINCT     
                         dbo.SalesConfiguration.Isbn, dbo.SalesConfiguration.SellerId, dbo.SalesConfiguration.SalesChannel, dbo.SalesConfiguration.State, dbo.SalesConfiguration.SalesFormId,     
                         dbo.SalesConfiguration.CreatedDate, dbo.SalesConfiguration.RevisionNumber, dbo.SalesConfiguration.CreatedBy, dbo.SalesConfiguration.TrialLicenseId, dbo.SalesConfiguration.RefSalesConfigTypeCode,     
                         dbo.RefSalesForm.Code AS RefSalesCode, dbo.RefSalesForm.DisplayName AS RefSalesDisplayName, dbo.RefAccessForm.Code AS RefAccessFormCode, dbo.RefAccessForm.DisplayName AS RefAccessFormDisplayName,     
                         dbo.PeriodPrice.UnitPrice, dbo.PeriodPrice.UnitPriceVat, dbo.PeriodPrice.UnitValue, dbo.PeriodPrice.RefPeriodTypeCode, dbo.RefPeriodUnitType.DisplayName AS RefPeriodTypeDisplayName,     
                         dbo.RefPriceModel.Code AS RefPriceModelCode, dbo.RefPriceModel.DisplayName AS RefPriceModelDisplayName,  
						coalesce ([dbo].[Product].[IsExternalLogin], 0) IsExternalLogin,
						 "ProductAccessProvider" = 
                              CASE 
                                 WHEN (select count(id) from [dbo].[ProductAccessProvider] where ProductId= [dbo].[Product].Id) =  0 THEN 0
                                 ELSE 1
                              END,
                          ROW_NUMBER() OVER (ORDER BY (SELECT 1)) AS Id  
FROM            dbo.SalesConfiguration LEFT OUTER JOIN    
                         dbo.SalesForm ON dbo.SalesConfiguration.SalesFormId = dbo.SalesForm.Id LEFT OUTER JOIN    
                         dbo.RefSalesForm ON dbo.SalesForm.RefSalesFormCode = dbo.RefSalesForm.Code LEFT OUTER JOIN    
                         dbo.AccessForm ON dbo.AccessForm.SalesConfigurationId = dbo.SalesConfiguration.Id LEFT OUTER JOIN    
                         dbo.RefAccessForm ON dbo.AccessForm.RefCode = dbo.RefAccessForm.Code LEFT OUTER JOIN    
                         dbo.PeriodPrice ON dbo.PeriodPrice.AccessFormId = dbo.AccessForm.Id LEFT OUTER JOIN    
                         dbo.RefPeriodUnitType ON dbo.RefPeriodUnitType.Code = dbo.PeriodPrice.RefPeriodTypeCode LEFT OUTER JOIN    
                         dbo.PriceModel ON dbo.PriceModel.AccessFormId = dbo.AccessForm.Id LEFT OUTER JOIN    
                         dbo.RefPriceModel ON dbo.RefPriceModel.Code = dbo.PriceModel.RefPriceModelCode  LEFT OUTER JOIN 
                         [dbo].[Product] ON dbo.SalesConfiguration.Isbn = [dbo].[Product].Isbn
						   
WHERE        (dbo.RefAccessForm.Code <> 1005) AND dbo.SalesConfiguration.State =1002
GO
-- Refactoring step to update target server with deployed transaction logs

IF OBJECT_ID(N'dbo.__RefactorLog') IS NULL
BEGIN
    CREATE TABLE [dbo].[__RefactorLog] (OperationKey UNIQUEIDENTIFIER NOT NULL PRIMARY KEY)
    EXEC sp_addextendedproperty N'microsoft_database_tools_support', N'refactoring log', N'schema', N'dbo', N'table', N'__RefactorLog'
END
GO
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '40677309-3065-47ad-b6f2-6c8bfdc4753b')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('40677309-3065-47ad-b6f2-6c8bfdc4753b')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '509c4388-cc48-46e4-9783-adbfc34ad01a')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('509c4388-cc48-46e4-9783-adbfc34ad01a')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '560a9f00-e386-4e35-b499-a15a37341dd2')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('560a9f00-e386-4e35-b499-a15a37341dd2')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = 'dff428cb-5444-44db-a093-58519ebddcc3')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('dff428cb-5444-44db-a093-58519ebddcc3')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '7bb63826-89bc-48d1-a55c-34058dccf9bd')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('7bb63826-89bc-48d1-a55c-34058dccf9bd')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '580fb8dc-579e-47ba-a179-e0ae10185b31')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('580fb8dc-579e-47ba-a179-e0ae10185b31')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '84ff1e01-e375-4051-be96-314f80d6bea6')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('84ff1e01-e375-4051-be96-314f80d6bea6')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '63315d65-4e8d-4358-80c0-b878fef1448d')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('63315d65-4e8d-4358-80c0-b878fef1448d')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '996b82a9-60c7-4359-be51-ee5eb2d08f84')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('996b82a9-60c7-4359-be51-ee5eb2d08f84')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '2946c98e-5b25-41d2-b9ee-e68c3f029cee')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('2946c98e-5b25-41d2-b9ee-e68c3f029cee')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '8abdd0d9-bf99-4d99-8bdb-c941e2704622')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('8abdd0d9-bf99-4d99-8bdb-c941e2704622')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '9c1a6d55-79ca-4d60-a994-d46aaca78808')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('9c1a6d55-79ca-4d60-a994-d46aaca78808')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = 'c5263f43-efa2-4674-9fc1-c52320543a77')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('c5263f43-efa2-4674-9fc1-c52320543a77')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '7dd42961-5ac2-496e-98e3-2e5b3e4b970a')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('7dd42961-5ac2-496e-98e3-2e5b3e4b970a')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = 'ded82f81-7185-4a01-b9bb-9dcbde7f30a4')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('ded82f81-7185-4a01-b9bb-9dcbde7f30a4')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '33f56b1c-be7e-43d8-8721-f85f1b57f3dc')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('33f56b1c-be7e-43d8-8721-f85f1b57f3dc')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '71b44a59-cb8a-466a-927d-b53d7637cc41')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('71b44a59-cb8a-466a-927d-b53d7637cc41')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '49eba622-23ee-4ffa-af4d-79931dcc9a82')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('49eba622-23ee-4ffa-af4d-79931dcc9a82')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '93bc6876-5c7c-4378-bef4-f1138c7752f1')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('93bc6876-5c7c-4378-bef4-f1138c7752f1')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '2ad039dd-3fb0-4c05-8ea3-56adea82ea35')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('2ad039dd-3fb0-4c05-8ea3-56adea82ea35')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '5833656e-1b12-429a-968e-6d7d9df846fb')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('5833656e-1b12-429a-968e-6d7d9df846fb')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '98aeff9b-2d05-4fb7-947e-da90006c04cf')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('98aeff9b-2d05-4fb7-947e-da90006c04cf')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '9e0f07b0-d6b0-4a98-ab4e-40973231bb70')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('9e0f07b0-d6b0-4a98-ab4e-40973231bb70')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '5d59fe7d-0735-446b-a89e-57d7e9a16949')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('5d59fe7d-0735-446b-a89e-57d7e9a16949')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = 'e9251e02-0b03-4ca2-8772-6b48f55b4f2d')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('e9251e02-0b03-4ca2-8772-6b48f55b4f2d')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '5e56c8bd-eee4-4d3e-9da3-d8e0888543a3')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('5e56c8bd-eee4-4d3e-9da3-d8e0888543a3')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = 'd6102a52-4ffc-4162-b236-531ffd4866af')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('d6102a52-4ffc-4162-b236-531ffd4866af')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '863b6c39-0d35-4244-84a2-ea4b7a9034ea')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('863b6c39-0d35-4244-84a2-ea4b7a9034ea')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = 'e444e73a-080a-4f82-97f7-a0bcffa6bce8')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('e444e73a-080a-4f82-97f7-a0bcffa6bce8')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '15850ff4-b336-4184-a5de-5b43217f8d7c')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('15850ff4-b336-4184-a5de-5b43217f8d7c')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '8c4ab0a6-9fae-4811-b515-b8c1b9df3360')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('8c4ab0a6-9fae-4811-b515-b8c1b9df3360')

GO

GO
PRINT N'Checking existing data against newly created constraints';


GO
USE [$(DatabaseName)];


GO
ALTER TABLE [dbo].[AccessForm] WITH CHECK CHECK CONSTRAINT [FK_AccessForm_RefAccessForm];

ALTER TABLE [dbo].[AccessForm] WITH CHECK CHECK CONSTRAINT [FK_AccessForm_SalesConfiguration];

ALTER TABLE [dbo].[PeriodPrice] WITH CHECK CHECK CONSTRAINT [FK_PeriodPrice_RefPeriodUnitType];

ALTER TABLE [dbo].[PeriodPrice] WITH CHECK CHECK CONSTRAINT [FK_Period_AccessForm];

ALTER TABLE [dbo].[PriceModel] WITH CHECK CHECK CONSTRAINT [FK_PriceModel_AccessForm];

ALTER TABLE [dbo].[PriceModel] WITH CHECK CHECK CONSTRAINT [FK_PriceModel_RefPriceModel];

ALTER TABLE [dbo].[ProductAccessProvider] WITH CHECK CHECK CONSTRAINT [FK_AccessProvider];

ALTER TABLE [dbo].[ProductAccessProvider] WITH CHECK CHECK CONSTRAINT [FK_Product];

ALTER TABLE [dbo].[RefDealer] WITH CHECK CHECK CONSTRAINT [FK_RefDealer_RefDealerText];

ALTER TABLE [dbo].[RefPeriod] WITH CHECK CHECK CONSTRAINT [FK_RefPeriod_RefPeriodUnitType];

ALTER TABLE [dbo].[RefPriceModel] WITH CHECK CHECK CONSTRAINT [FK_RefPriceModel_RefAccessForm];

ALTER TABLE [dbo].[SalesConfiguration] WITH CHECK CHECK CONSTRAINT [FK_SalesConfiguration_RefSalesConfigType];

ALTER TABLE [dbo].[SalesConfiguration] WITH CHECK CHECK CONSTRAINT [FK_SalesConfiguration_SalesForm];

ALTER TABLE [dbo].[SalesConfiguration] WITH CHECK CHECK CONSTRAINT [FK_SalesConfiguration_Seller];

ALTER TABLE [dbo].[SalesConfiguration] WITH CHECK CHECK CONSTRAINT [FK_SalesConfiguration_TrialLicense];

ALTER TABLE [dbo].[SalesForm] WITH CHECK CHECK CONSTRAINT [FK_SalesForm_RefSalesForm];

ALTER TABLE [dbo].[TrialCount] WITH CHECK CHECK CONSTRAINT [FK_TrialCount_RefTrialCountUnitType];

ALTER TABLE [dbo].[TrialLicense] WITH CHECK CHECK CONSTRAINT [FK_TrialLicense_TrialCount];

ALTER TABLE [dbo].[TrialLicense] WITH CHECK CHECK CONSTRAINT [FK_TrialLicense_RefTrialAccessForm];

ALTER TABLE [dbo].[TrialLicense] WITH CHECK CHECK CONSTRAINT [FK_TrialLicense_TrialPeriod];

ALTER TABLE [dbo].[TrialPeriod] WITH CHECK CHECK CONSTRAINT [FK__TrialPeri__RefTr__656C112C];


GO
PRINT N'Update complete.';


GO
